version: '2'
default_locale: en
locales:
  $ref: locales.yml
template:
  name: Secure container toolchain
  description: >-
    With this toolchain, you can develop and deploy a secure Docker container
    application. By default, the toolchain uses a sample Node.js "Hello World"
    app, but you can link to your own GitHub repository instead. This toolchain
    is preconfigured for continuous delivery with [Vulnerability
    Advisor](https://www.ibm.com/blogs/bluemix/2016/06/docker-container-security-with-vulnerability-advisor/),
    source control, issue tracking, and online editing.

     **First-time containers service users**: Make sure that your containers service is correctly set up by [identifying the image repository for your organization](https://new-console.ng.bluemix.net/docs/containers/container_creating_ov.html#container_namespace). Also, check your org container quotas by clicking **Manage Organizations**, selecting your org, and clicking **Edit Org > Quota > Containers > Edit**. For more information about getting started with IBM Containers, see [this tutorial](https://console.ng.bluemix.net/docs/containers/container_gettingstarted_tutorial.html#container_gettingstarted_tutorial_lesson_1).

    This toolchain uses tools that are part of the Continuous Delivery service.
    If an instance of that service isn't already in your organization, when you
    click **Create**, it is automatically added at no cost to you. For more
    information and terms, see the [Bluemix
    catalog](/catalog/services/continuous-delivery/).


    To get started, click **Create**.
  header: '![](simple-toolchain-cont.svg?localize)'
  icon: icon.svg
  required:
    - hello-world-build
    - hello-world-repo
  info:
    git url: >-
      [https://github.com/open-toolchain/secure-container-toolchain](https://github.com/open-toolchain/secure-container-toolchain)
    git branch: >-
      [master](https://github.com/open-toolchain/secure-container-toolchain/tree/master)
toolchain:
  name: 'secure-container-toolchain-{{timestamp}}'
  template:
    getting_started: |-
      **Your toolchain is ready!**
      
      **Quick start:** Commit a change to the Git repo to trigger a new build and deployment and check for container security vulnerabilities.
      For step-by-step instructions, see the [tutorial](https://www.ibm.com/devops/method/tutorials/tutorial_toolchain_secure_container) for this toolchain.      
services:
  hello-world-repo:
    service_id: githubpublic
    parameters:
      repo_name: 'hello-containers-{{timestamp}}'
      repo_url: 'https://github.com/open-toolchain/hello-containers'
      type: clone
      has_issues: true
  hello-world-build:
    service_id: pipeline
    parameters:
      services:
        - hello-world-repo
      name: 'hello-world-{{timestamp}}'
      ui-pipeline: true
      configuration:
        content:
          $text: pipeline.yml
        env:
          HELLO_WORLD_REPO: hello-world-repo
          CF_APP_NAME: '{{form.pipeline.parameters.hello-world-name}}'
          PROD_SPACE_NAME: '{{form.pipeline.parameters.prod-space}}'
          PROD_ORG_NAME: '{{form.pipeline.parameters.prod-organization}}'
          PROD_REGION_ID: '{{form.pipeline.parameters.prod-region}}'
        execute: true
  webide:
    service_id: orion
form:
  pipeline:
    parameters:
      hello-world-name: '{{services.hello-world-repo.parameters.repo_name}}'
    schema:
      $ref: deploy.json
